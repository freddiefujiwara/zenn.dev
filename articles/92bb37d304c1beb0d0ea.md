---
title: "Google Homeã‚’ä½¿ã£ã¦è¦å‰‡æ­£ã—ã„ç”Ÿæ´»ã‚’ã—ãŸã„"
emoji: "ğŸ˜½"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["ifttt","gas","GoogleAppsScript","GoogleHome"]
published: true
---

# ã¯ã˜ã‚ã«
ã“ã®ã”æ™‚ä¸–ã§ã™ã®ã§ã¿ãªã•ã‚“ã‚‚å®¶æ—å…¨å“¡ã§å¼•ãã“ã‚‚ã‚Šç”Ÿæ´»ã‚’ã•ã‚Œã¦ã„ã‚‹ã®ã§ã¯ãªã„ã‹ã¨æ€ã„ã¾ã™ã€‚
åœ¨å®…ãƒ¯ãƒ¼ã‚¯ã‚„ã£ã¦ã¦æ€ã†ã“ã¨ã€‚å­¦æ ¡ãŒç„¡ã„ã®ã§ã©ã‚“ã©ã‚“ç”Ÿæ´»ãƒªã‚ºãƒ ãŒå´©ã‚Œã¦ã—ã¾ã†ã€‚
ãã‚“ãªäº‹ã¯ã‚ã‚Šã¾ã›ã‚“ã‹ï¼Ÿè¦ªã‚‚å­ã‚‚ã€Œè¦å‰‡æ­£ã—ã„ç”Ÿæ´»ã€ã‚’ã—ãªã„ã¨å¿ƒèº«ã«ãƒ€ãƒ¡ãƒ¼ã‚¸ãŒãã¾ã™ã€‚
æœã¯å®šæ™‚ã«èµ·ãã‚‹ã€‚
å‹‰å¼·ã€ä»•äº‹ã‚’ã™ã‚‹ã€‚
å¤œã¯æ—©ã‚ã«ã€‚
è¦å‰‡æ­£ã—ã„ç”Ÿæ´»ã‚’ã—ã¦ã€æ°—æŒã¡ã‚‚å®‰å®šã—ã¦éã”ã—ãŸã„ã§ã™ã‚ˆã­ã€‚
å¤šåˆ†ã€ã“ã‚“ãªGASã§ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½œã‚‰ãªãã¦ã‚‚IFTTTã ã‘ã§ã‚‚ã§ããã†ã§ã™ãŒã€
Spreadsheetã§ä¸€è¦§ã§ç®¡ç†ã—ãŸã„ã“ã¨ã‚‚ã‚ã‚Šã€
ãã‚“ãªã¨ãã€æˆ‘ãŒå®¶ã§å®Ÿè·µã—ã¦ã„ã‚‹Google Homeã¨Google Apps Scriptã‚’ä½¿ã£ãŸã€
ãƒãƒ£ã‚¤ãƒ ã¨ã„ã„ã¾ã™ã‹ã€ã‚¢ãƒ©ãƒ¼ãƒ ã‚·ã‚¹ãƒ†ãƒ ã‚’æ§‹ç¯‰ã—ã¾ã—ãŸã®ã§ã€ã”ç´¹ä»‹ã•ã›ã¦ã„ãŸã ãã¾ã™ã€‚
ã¡ãªã¿ã«ã€ç§ã®è‡ªå®…ã®ç’°å¢ƒã¯[ã“ã®ã‚ˆã†ãª](https://qiita.com/freddiefujiwara/items/4f340c32c86312705c94)æ„Ÿã˜ã«ãªã£ã¦ã„ã¾ã™ã€‚

![Google Homeã«å–‹ã‚‰ã›ã¦ã¿ãŸ.png](https://qiita-image-store.s3.amazonaws.com/0/1817/ba4fc8cb-8955-54d1-0ae6-7c7b090e034d.png)
ã¾ãŸã€ãã‚Œãã‚Œã®æ™‚é–“ã§push callã—ãŸã„ã€æ–‡è¨€ã‚’ä¸‹è¨˜ã«ãªã‚‰ã¹ã¾ã™ã€‚


| Alerm            |      Push Message                                    | 
|:-----------------|------------------------------------------------------:|
|6:00:00 AM        |HHæ™‚MMåˆ†ã§ã™ã€‚æœã«ãªã‚Šã¾ã—ãŸï¼èµ·ãã¾ã—ã‚‡ã†ã€‚| 
|6:30:00 AM        |HHæ™‚MMåˆ†ã§ã™ã€‚ãã‚ãã‚èµ·ãã¾ã—ã‚‡ã†ã€‚ç§ã¯ã™ã£ã‹ã‚Šèµ·ãã¾ã—ãŸã‚ˆ| 
|7:00:00 AM        |HHæ™‚MMåˆ†ã§ã™ã€‚ã•ã™ãŒã«ãã‚ãã‚èµ·ãã¾ã—ã‚‡ã†ã€‚é‹å‹•ã‚„èªå­¦ã®å‹‰å¼·ãªã‚“ã‹ã©ã†ã§ã™ã‹ï¼Ÿ| 
|8:00:00 AM        |HHæ™‚MMåˆ†ã§ã™ã€‚æœã”ã¯ã‚“ã‚’é£Ÿã¹ã¾ã—ã‚‡ã†| 
|10:00:00 AM       |HHæ™‚MMåˆ†ã§ã™ã€‚ãã‚ãã‚ä¼‘æ†©ã§ã‚‚ã„ã‹ãŒã§ã—ã‚‡ã†ã‹| 
|12:00:00 PM       |HHæ™‚MMåˆ†ã§ã™ã€‚ãŠæ˜¼ã”ã¯ã‚“ã®æº–å‚™ã‚’å§‹ã‚ã¾ã—ã‚‡ã†| 
|1:00:00 PM        |HHæ™‚MMåˆ†ã§ã™ã€‚ãŠæ˜¼ã”ã¯ã‚“ã‚’é£Ÿã¹ã¾ã—ã‚‡ã†| 
|3:00:00 PM        |HHæ™‚MMåˆ†ã§ã™ã€‚ãã‚ãã‚ãŠã‚„ã¤ã®æ™‚é–“ã‹ãª?| 
|5:30:00 PM        |HHæ™‚MMåˆ†ã§ã™ã€‚æ™©ã”ã¯ã‚“ã®æº–å‚™ã‚’å§‹ã‚ã¾ã—ã‚‡ã†| 
|6:30:00 PM        |HHæ™‚MMåˆ†ã§ã™ã€‚æ™©ã”ã¯ã‚“ã‚’é£Ÿã¹ã¾ã—ã‚‡ã†| 
|8:30:00 PM        |HHæ™‚MMåˆ†ã§ã™ã€‚ãŠé¢¨å‘‚ã«å…¥ã‚Šã¾ã—ã‚‡ã†| 
|10:00:00 PM       |HHæ™‚MMåˆ†ã§ã™ã€‚ãã‚ãã‚å¯ã¾ã—ã‚‡ã†ã€‚ç§ã¯å¯ã¾ã™ã€‚ãŠã‚„ã™ã¿ãªã•ã„| 

![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/1817/c89208eb-ed63-2f57-54df-bfba6f9e38ab.png)



# 1)IFTTTå´ã®æº–å‚™
## 1-1)My Servicesã«è¡Œãã¾ã™
![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/1817/b99a07cf-2726-cfa9-ab90-b3301acde053.png)

## 1-2)Webhookã‚’è¨­å®š
![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/1817/c1c93b18-c17a-92ff-7b78-9156dafd4d6d.png)

Webhooks>settingã«è¡Œãã¾ã™
![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/1817/9f72c424-576f-9333-95fd-872651f08d20.png)

ä¸‹è¨˜ã®èµ¤æ ã®URLã‚’ã‚³ãƒ”ãƒšã—ã¦ãƒ–ãƒ©ã‚¦ã‚¶ã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã«è²¼ã‚Šä»˜ã‘ã¦è¡Œãã¾ã™
![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/1817/a50e3443-04a4-6949-0946-d619c4509b26.png)

é·ç§»ã—ãŸã‚‰ Triggerã®å³æ¨ªã®{{event}}ã£ã¦æ›¸ã„ã¦ã‚ã‚‹ç®‡æ‰€ã‚’"alarm"ã«å¤‰æ›´ã—,
curl -X POSTã®å³å´ã®URLã‚’ã‚³ãƒ”ãƒ¼ã—ã¦èµ·ãã¾ã™
![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/1817/94bd09be-275b-2d30-51d4-172d6f07e9e5.png)

# 2)Googleå´ã®æº–å‚™
## 2-1)Spreadsheetã‚’ä½œæˆ
Spreadã‚·ãƒ¼ãƒˆã«ã¯ãƒˆãƒªã‚¬ãƒ¼ã«ã—ãŸã„GMailã‚’ä¸‹è¨˜ã®ã‚ˆã†ã«ä½œæˆã—ã¾ã—ã‚‡ã†

- Aåˆ— ã‚¢ãƒ©ãƒ¼ãƒ ã‚’ã‚»ãƒƒãƒˆã—ãŸã„æ™‚é–“
- Båˆ—ã¯ã€€=ENCODEURL(CONCATENATE(HOUR(A12),"æ™‚",MINUTE(A12),"åˆ†ã§ã™ã€‚ä½•ã‹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸"))

![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/1817/98101e39-031a-8329-f71b-2d9325b2daf5.png)


##2-2)GASã‚’ä½œæˆ
å…ˆç¨‹ã®Spreadsheetã‹ã‚‰Tools>Scripteditoã‚’é¸æŠã—ã¾ã™
![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/1817/5da4a118-d6f7-6751-fa94-1c0b1ccb4be4.png)

##2-3)GASã‚’å®Ÿè£…
ä¸‹è¨˜ã®èµ¤æ ã®éƒ¨åˆ†ã«
![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/1817/55e243fb-4160-56a0-e69f-74d2f9d1a523.png)

IFTTTã®URLã®éƒ¨åˆ†ã‚’1-2)ã§ã‚³ãƒ”ãƒ¼ã—ãŸã‚‚ã®ã«å¤‰æ›´ã—ã¦ä¿å­˜ã—ã¦ãã ã•ã„

```JavaScript
function myFunction() {
	// !!please set your ifttt webhook url!!
	var IFTTT = 'https://maker.ifttt.com/trigger/ã•ã£ãä¿å­˜ã˜ãŸURL';
	// get data from spread sheet
	var labels = SpreadsheetApp.getActiveSheet().getDataRange().getValues();
	// for all labes;
	for (var v = 0; v < labels.length; v++) {
		if (labels[v].length < 2) {
			return;
		}

		// calculate the time difference between now and target
		var now = new Date();
		var target = new Date(labels[v][0]);
		// adjust target's YYYY/MM/DD to current YYYY/MM/DD
		target.setFullYear(now.getFullYear());
		target.setMonth(now.getMonth());
		target.setDate(now.getDate());

		// trigger "alarm" if the difference is within 50 secs
		if (Math.abs(now - target) < 50 * 1000) {
			//  POST IFTTT if you've got "alarm"
			Logger.log(IFTTT);
			var res = UrlFetchApp.fetch(IFTTT, {
				'muteHttpExceptions': true,
				'method': 'post',
				'contentType': 'application/json',
				'payload': JSON.stringify({
					"value1": labels[v][1]
				})
			});
			Logger.log("Response:" + res);
		}
	}
}
```
## 2-4)GASã‚’ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
ä¸‰è§’ã®çŸ¢å°ã‚’æŠ¼ä¸‹ã—ã¦ãã ã•ã„
åˆå›ã¯è‰²ã€…GoogleSpreadsheetã‚„Gmailã¨ã®é€£æºã‚’ã™ã‚‹ãŸã‚ã«ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—ãŒã§ã¾ã™ãŒ
ã™ã¹ã¦è¨±å¯ã—ã¦ã¤ãªã„ã§ãã ã•ã„

![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/1817/bd1700f7-8d41-b970-d3d7-3f52b0076c8b.png)


## 2-5)GAS Triggerã‚’è¨­å®š
æœ€å¾Œã«ã“ã“ã‚’æŠ¼ã—ã¦
![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/1817/466a1cb8-3783-f9e8-5efe-1d1b6c2a006f.png)

"+Add Trigger"ã‚’æŠ¼ã—ã¦æ–°ã—ã„ãƒˆãƒªã‚¬ãƒ¼ã‚’ä¸‹è¨˜ã®æ§˜ã«è¨­å®šã—ã¾ã—ã‚‡ã†
![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/1817/0e18fdad-bdef-70b1-092a-ea1d3dc5ba49.png)

# ãƒ‡ãƒ¢
[![IMAGE ALT TEXT HERE](http://img.youtube.com/vi/W7x76ws5jV8/0.jpg)](http://www.youtube.com/watch?v=W7x76ws5jV8)

# æœ€å¾Œã«
çš†ã•ã¾ã€æœ€å¾Œã¾ã§ã”è¦§ã„ãŸã ãã€ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸã€‚
ã„ã‹ãŒã§ã—ãŸã‹ï¼Ÿ
å°‘ã—ã§ã‚‚è¦å‰‡æ­£ã—ã„ç”Ÿæ´»ã®åŠ©ã‘ã«ãªã£ãŸã‚‰å¹¸ã„ã§ã™ã€‚
ã„ã„ãªã€ã¨æ€ã£ãŸã‚‰LGTMãŠé¡˜ã„ã—ã¾ã™ï¼
