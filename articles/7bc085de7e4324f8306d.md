---
title: "ãƒã‚¤ãƒ¤ãƒ¼ã‚ºã®ä¸‰è§’å½¢ã®å•é¡Œã®ãƒ†ã‚¹ãƒˆå¯¾è±¡ã‚’ google formsã§ä½œã‚‹"
emoji: "ğŸ“Œ"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["gas","ãƒ†ã‚¹ãƒˆ","GoogleAppsScript","googleform"]
published: true
---

# ã¯ã˜ã‚ã«
ã¿ãªã•ã‚“ "ãƒã‚¤ãƒ¤ãƒ¼ã‚ºã®ä¸‰è§’å½¢ã®å•é¡Œ"ã¨ã„ã†ã®ã‚’ã”å­˜çŸ¥ã§ã—ã‚‡ã†ã‹
3è¾ºã®é•·ã•ã‚’ã‚ã‚‰ã‚ã™3ã¤ã®æ•´æ•°ã‚’èª­ã¿ã¨ã‚Š
å‡ºåŠ›ã¨ã—ã¦ã€ä¸ç­‰è¾ºä¸‰è§’å½¢ã€äºŒç­‰è¾ºä¸‰è§’å½¢ã€æ­£ä¸‰è§’å½¢ã‚’åˆ¤åˆ¥ã—ã¦è¡¨ç¤ºã™ã‚‹ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã«å¯¾ã—ã¦
ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ã‚’æ›¸ãã¨ã„ã†ã‚¨ã‚¯ã‚µã‚µã‚¤ã‚ºã§ã™ã€‚
ã“ã‚Œã¯ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ã‚’è€ƒæ¡ˆã™ã‚‹ãŸã‚ã®ã‚¨ã‚¯ã‚µã‚µã‚¤ã‚ºã¨ã—ã¦çŸ¥ã‚‰ã‚Œã¦ã„ã¾ã™
è€ƒæ¡ˆã—ãŸã®ã¯ã€ã‚°ãƒ¬ãƒ³ãƒ•ã‚©ãƒ¼ãƒ‰ãƒ»ãƒã‚¤ãƒ¤ãƒ¼ã‚ºã¨ã„ã†äººã§åå‰ã‚’èã„ãŸã“ã¨ãŒã‚ã‚‹äººã‚‚å¤šã„ã§ã—ã‚‡ã†ã€‚
å½¼ã®åå‰ã¯ã€ã„ã‚ã‚“ãªãƒ†ã‚¹ãƒˆé–¢é€£ã®è³‡æ–™ã®ä¸­ã«å‡ºã¦ãã¾ã™ãŒã€
"The Art of Software Testing "ã®è‘—è€…ã¨ã—ã¦æœ‰åã§ã™ã€‚
ä»Šå›ã“ã®ã‚¨ã‚¯ã‚µã‚µã‚¤ã‚ºã‚’é€²ã‚ã¦ãƒ†ã‚¹ãƒˆå®Ÿè¡Œã™ã‚‹ãŸã‚ã®å¯¾è±¡ã¨ã—ã¦google formã‚’ä½¿ã£ã¦ä½œã£ã¦ã¿ãŸã„ã¨æ€ã„ã¾ã™


# Step 01.ãƒ•ã‚©ãƒ¼ãƒ ã‚’ä½œæˆã™ã‚‹
ã“ã®ãƒ•ã‚©ãƒ¼ãƒ ã®ç›®çš„ã¯ã€A,Bã¨Cã¨ã„ã†3ã¤ã®å…¥åŠ›ã‹ã‚‰
ä¸‰è§’å½¢ã®ã‚¿ã‚¤ãƒ—(æ­£ä¸‰è§’å½¢ã‹äºŒç­‰è¾ºä¸‰è§’å½¢ã‹æ™®é€šã®ä¸‰è§’å½¢ã‹)ã‚’è¨ˆç®—ã—ã€
ç­”ãˆã‚’è¡¨ç¤ºã™ã‚‹ã“ã¨ã§ã™ã€‚
å–ã‚Šæ€¥ãã“ã‚“ã‹ãƒ•ã‚©ãƒ¼ãƒ ã‚’ä½œæˆã—ã¾ã—ã‚‡ã†
![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/1817/5a9c138d-f3f6-cae4-251e-f741c984c814.png)

# Step 03. ãƒ•ã‚©ãƒ¼ãƒ ã®å…¥åŠ›ã‚’Spread Sheetã«è¿½åŠ ã™ã‚‹è¨­å®šã‚’å…¥ã‚Œã‚‹
æœ€çµ‚çš„ãªç­”ãˆã¯spreadsheetã«è¨˜è¼‰ã•ã‚Œã‚‹ãŸã‚Formã®æ©Ÿèƒ½ã‚’ä½¿ã£ã¦Spread sheetã¨é€£æºã•ã›ã¾ã—ã‚‡ã†
![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/1817/f4b65a44-d41f-dbc2-2386-32dc80fc57d2.png)
ã“ã¡ã‚‰ã‚’é€£æºã•ã›ã¾ã™

â†‘ã®SpreadSheetã®URLã®éƒ¨åˆ†
https://docs.google.com/spreadsheets/d/XXXXXXX/edit#gid=1030984857
ã“ã®XXXXã®éƒ¨åˆ†ã‚’ãƒ¡ãƒ¢ã£ã¦ãŠã„ã¦ãã ã•ã„

# Step02. ä¸‰è§’å½¢ã‚’è¨ˆç®—ã™ã‚‹ãƒ­ã‚¸ãƒƒã‚¯ã‚’Google Apps Scriptã§å®Ÿè£…ã—ã€é€£æºã•ã›ã¾ã™
![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/1817/30c7d139-37b6-bc49-00da-cead09f5cd47.png)
ã“ã“ã‚’æŠ¼ã™ã¨Google App Scriptã‚’è¿½åŠ ã§ãã¾ã™
![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/1817/f8c1f8cf-3951-cfef-c479-13ce4cb889f5.png)

ã“ã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã®éƒ¨åˆ†ã«ä¸‹è¨˜ã‚’ã‚³ãƒ”ãƒšã—ã¦è²¼ã‚Šä»˜ã‘ã¦ãã ã•ã„

```JavaScript
/**
 * myFunction: main function
 *
 * @return void
 *
 **/
function myFunction() {
	//gather inputs A,B and C from the form
	var inputs = new Array(3); // [A,B,C]
	var form = FormApp.getActiveForm(); // this form
	var formResponses = form.getResponses(); // this response
	for (var i = 0; i < formResponses.length; i++) {
		var itemResponses = formResponses[i].getItemResponses();
		for (var j = 0; j < itemResponses.length; j++) {
			inputs[j] = itemResponses[j].getResponse();
		}
	}

	//validate
	var type = "error"; // default type is "error"
	// type has changed if there are all valid inputs 
	if (validInput(inputs[0], inputs[1], inputs[2])) {
		//categorize the triangle type from inputs
		type = triangleType(inputs[0], inputs[1], inputs[2]);
	}
  
    // log inputs and type
	Logger.log(inputs);
	Logger.log(type);
  
    // put the anser to last row
	var sheet = SpreadsheetApp.openById("Step2ã§ãƒ¡ãƒ¢ã£ãŸXXXXXX").getSheets()[0];
	var lastRow = sheet.getLastRow();
     
	sheet.getRange(lastRow, 5).setValue(type);
}

/**
 * validateInput: vaidate Inputs
 *
 * @parameter A:integer
 * @parameter B:integer
 * @parameter C:integer
 * @return boolean
 *
 **/
function validInput(A, B, C) {
	// A,B and C all should be a number
	if (isNaN(A) || isNaN(B) || isNaN(C)) {
		return false;
	}
	// A,B and C all should be a integer
	if (!parseInt(Number(A)) == A || !parseInt(Number(B)) == B || !parseInt(Number(C)) == C) {
		return false;
	}
	// A,B and C all should be a positive integer
	if (A < 0 || B < 0 || C < 0) {
		return false;
	}
	// A,B and C all should be less than MAX_VALUE
	if (A > Number.MAX_SAFE_INTEGER || B > Number.MAX_SAFE_INTEGER || C > Number.MAX_SAFE_INTEGER) {
		return false;
	}
	return true;
}

/**
 * triangleType: categorize the triangle from inputs
 *
 * @parameter A:integer
 * @parameter B:integer
 * @parameter C:integer
 * @return string
 *
 **/
function triangleType(A, B, C) {
	// transform to integer type
	A = parseInt(Number(A));
	B = parseInt(Number(B));
	C = parseInt(Number(C));
	// can create a triangle?
	if (!(Math.abs(A - B) < C && C < A + B)) {
		return "not a triangle";
	}
	// can be a equilateral triangle
	if (A === B && B === C && C === A) {
		return "equilateral triangle";
	}
	// can be a isosceles triangle
	if (A === B || B === C || C === A) {
		return "isosceles triangle";
	}
	// or normal
	return "normal triangle";
}
```


# Step 04. ãƒˆãƒªã‚¬ãƒ¼ã‚’è¨­å®šã™ã‚‹
å…ˆç¨‹ã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã®ç”»é¢ã§
![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/1817/c0da59e0-136a-51e7-4cfc-4fe24d940797.png)
ã“ã¡ã‚‰ã‚’é¸æŠ "+ Add Trigger"ã‚’æŠ¼ä¸‹ã—ã¦
![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/1817/e29bcb7e-c554-ec8e-6a1a-1c17ec7f67b3.png)
ã®ã‚ˆã†ã«è¨­å®šã—ã¦
çµ‚ã‚ã‚Š

# ãƒ‡ãƒ¢
ãƒ‡ãƒ¢ã¯ã“ã¡ã‚‰ã§ã™
https://forms.gle/Z6aCtEYeiW37Vzr66

æœ€å¾Œã¾ã§èª­ã‚“ã§ã„ãŸã ãã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸï¼ï¼

